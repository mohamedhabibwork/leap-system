syntax = "proto3";

package audit;

service AuditService {
  rpc FindAll(FindAllAuditRequest) returns (FindAllAuditResponse);
  rpc FindOne(FindOneAuditRequest) returns (AuditLog);
  rpc FindByUser(FindByUserRequest) returns (FindByUserResponse);
  rpc Create(CreateAuditRequest) returns (AuditLog);
  // Admin-specific RPCs
  rpc FindAllPaginated(FindAllAuditPaginatedRequest) returns (FindAllAuditPaginatedResponse);
  rpc FindByDateRange(FindByDateRangeRequest) returns (FindAllAuditPaginatedResponse);
}

message AuditLog {
  int32 id = 1;
  string uuid = 2;
  int32 userId = 3;
  string auditableType = 4;
  int32 auditableId = 5;
  string action = 6;
  string oldValues = 7;
  string newValues = 8;
  string description = 9;
  string ipAddress = 10;
  string userAgent = 11;
  string createdAt = 12;
}

message FindAllAuditRequest {}

message FindAllAuditResponse {
  repeated AuditLog logs = 1;
}

message FindOneAuditRequest {
  int32 id = 1;
}

message FindByUserRequest {
  int32 userId = 1;
}

message FindByUserResponse {
  repeated AuditLog logs = 1;
}

message CreateAuditRequest {
  int32 userId = 1;
  string auditableType = 2;
  int32 auditableId = 3;
  string action = 4;
  string oldValues = 5;
  string newValues = 6;
  string description = 7;
  string ipAddress = 8;
  string userAgent = 9;
}

// Admin-specific messages
message FindAllAuditPaginatedRequest {
  int32 page = 1;
  int32 limit = 2;
  string action = 3;
  string auditableType = 4;
}

message FindAllAuditPaginatedResponse {
  repeated AuditLog logs = 1;
  int32 total = 2;
  int32 page = 3;
  int32 limit = 4;
  int32 totalPages = 5;
}

message FindByDateRangeRequest {
  string startDate = 1;
  string endDate = 2;
  int32 page = 3;
  int32 limit = 4;
}
